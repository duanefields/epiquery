#! /usr/bin/env node

var child_process = require('child_process');

var command = process.argv[2];
var interval = process.argv[3];

function run_process(){
  child_process.execFile('bash', ["-c", command],[], {}, dump_streams);
}

function dump_streams(err, stderr, stdout){
  console.log(stdout);
  if (err){
    console.error("Error from child:\n" + JSON.stringify(err));
  }
  console.error(stderr);
  setInterval(run_process, interval);
}


console.log("starting " + process.argv[0] + " with command '" + command + "' at interval " + interval);
run_process();
